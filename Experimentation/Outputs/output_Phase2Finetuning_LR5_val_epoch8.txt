Defaulting to user installation because normal site-packages is not writeable
Looking in indexes: https://download.pytorch.org/whl/cu121
Collecting torch
  Using cached https://download.pytorch.org/whl/cu121/torch-2.5.1%2Bcu121-cp312-cp312-linux_x86_64.whl (780.4 MB)
Collecting torchvision
  Using cached https://download.pytorch.org/whl/cu121/torchvision-0.20.1%2Bcu121-cp312-cp312-linux_x86_64.whl (7.3 MB)
Collecting torchaudio
  Using cached https://download.pytorch.org/whl/cu121/torchaudio-2.5.1%2Bcu121-cp312-cp312-linux_x86_64.whl (3.4 MB)
Collecting filelock (from torch)
  Using cached https://download.pytorch.org/whl/filelock-3.19.1-py3-none-any.whl.metadata (2.1 kB)
Collecting typing-extensions>=4.8.0 (from torch)
  Using cached https://download.pytorch.org/whl/typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Collecting networkx (from torch)
  Using cached https://download.pytorch.org/whl/networkx-3.5-py3-none-any.whl.metadata (6.3 kB)
Collecting jinja2 (from torch)
  Using cached https://download.pytorch.org/whl/jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)
Collecting fsspec (from torch)
  Using cached https://download.pytorch.org/whl/fsspec-2025.9.0-py3-none-any.whl.metadata (10 kB)
Collecting nvidia-cuda-nvrtc-cu12==12.1.105 (from torch)
  Using cached https://download.pytorch.org/whl/cu121/nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (23.7 MB)
Collecting nvidia-cuda-runtime-cu12==12.1.105 (from torch)
  Using cached https://download.pytorch.org/whl/cu121/nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (823 kB)
Collecting nvidia-cuda-cupti-cu12==12.1.105 (from torch)
  Using cached https://download.pytorch.org/whl/cu121/nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (14.1 MB)
Collecting nvidia-cudnn-cu12==9.1.0.70 (from torch)
  Using cached https://download.pytorch.org/whl/cu121/nvidia_cudnn_cu12-9.1.0.70-py3-none-manylinux2014_x86_64.whl (664.8 MB)
Collecting nvidia-cublas-cu12==12.1.3.1 (from torch)
  Using cached https://download.pytorch.org/whl/cu121/nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl (410.6 MB)
Collecting nvidia-cufft-cu12==11.0.2.54 (from torch)
  Using cached https://download.pytorch.org/whl/cu121/nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl (121.6 MB)
Collecting nvidia-curand-cu12==10.3.2.106 (from torch)
  Using cached https://download.pytorch.org/whl/cu121/nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl (56.5 MB)
Collecting nvidia-cusolver-cu12==11.4.5.107 (from torch)
  Using cached https://download.pytorch.org/whl/cu121/nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl (124.2 MB)
Collecting nvidia-cusparse-cu12==12.1.0.106 (from torch)
  Using cached https://download.pytorch.org/whl/cu121/nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl (196.0 MB)
Collecting nvidia-nccl-cu12==2.21.5 (from torch)
  Using cached https://download.pytorch.org/whl/nvidia_nccl_cu12-2.21.5-py3-none-manylinux2014_x86_64.whl (188.7 MB)
Collecting nvidia-nvtx-cu12==12.1.105 (from torch)
  Using cached https://download.pytorch.org/whl/cu121/nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (99 kB)
Collecting triton==3.1.0 (from torch)
  Using cached https://download.pytorch.org/whl/triton-3.1.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (209.6 MB)
Collecting setuptools (from torch)
  Using cached https://download.pytorch.org/whl/setuptools-70.2.0-py3-none-any.whl.metadata (5.8 kB)
Collecting sympy==1.13.1 (from torch)
  Using cached https://download.pytorch.org/whl/sympy-1.13.1-py3-none-any.whl (6.2 MB)
Collecting nvidia-nvjitlink-cu12 (from nvidia-cusolver-cu12==11.4.5.107->torch)
  Using cached https://download.pytorch.org/whl/nvidia_nvjitlink_cu12-12.9.86-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl.metadata (1.7 kB)
Collecting mpmath<1.4,>=1.1.0 (from sympy==1.13.1->torch)
  Using cached https://download.pytorch.org/whl/mpmath-1.3.0-py3-none-any.whl (536 kB)
Collecting numpy (from torchvision)
  Using cached https://download.pytorch.org/whl/numpy-2.3.3-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (62 kB)
Collecting pillow!=8.3.*,>=5.3.0 (from torchvision)
  Using cached https://download.pytorch.org/whl/pillow-11.3.0-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl.metadata (9.0 kB)
Collecting MarkupSafe>=2.0 (from jinja2->torch)
  Using cached https://download.pytorch.org/whl/MarkupSafe-2.1.5-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (28 kB)
Using cached https://download.pytorch.org/whl/pillow-11.3.0-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (6.6 MB)
Using cached https://download.pytorch.org/whl/typing_extensions-4.15.0-py3-none-any.whl (44 kB)
Using cached https://download.pytorch.org/whl/filelock-3.19.1-py3-none-any.whl (15 kB)
Using cached https://download.pytorch.org/whl/fsspec-2025.9.0-py3-none-any.whl (199 kB)
Using cached https://download.pytorch.org/whl/jinja2-3.1.6-py3-none-any.whl (134 kB)
Using cached https://download.pytorch.org/whl/networkx-3.5-py3-none-any.whl (2.0 MB)
Using cached https://download.pytorch.org/whl/numpy-2.3.3-cp312-cp312-manylinux_2_27_x86_64.manylinux_2_28_x86_64.whl (16.6 MB)
Using cached https://download.pytorch.org/whl/setuptools-70.2.0-py3-none-any.whl (930 kB)
Using cached https://download.pytorch.org/whl/nvidia_nvjitlink_cu12-12.9.86-py3-none-manylinux2010_x86_64.manylinux_2_12_x86_64.whl (39.7 MB)
Installing collected packages: mpmath, typing-extensions, sympy, setuptools, pillow, nvidia-nvtx-cu12, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, numpy, networkx, MarkupSafe, fsspec, filelock, triton, nvidia-cusparse-cu12, nvidia-cudnn-cu12, jinja2, nvidia-cusolver-cu12, torch, torchvision, torchaudio
  Attempting uninstall: mpmath
    Found existing installation: mpmath 1.3.0
    Uninstalling mpmath-1.3.0:
      Successfully uninstalled mpmath-1.3.0
  Attempting uninstall: typing-extensions
    Found existing installation: typing_extensions 4.15.0
    Uninstalling typing_extensions-4.15.0:
      Successfully uninstalled typing_extensions-4.15.0
  Attempting uninstall: sympy
    Found existing installation: sympy 1.13.1
    Uninstalling sympy-1.13.1:
      Successfully uninstalled sympy-1.13.1
  Attempting uninstall: setuptools
    Found existing installation: setuptools 70.2.0
    Uninstalling setuptools-70.2.0:
      Successfully uninstalled setuptools-70.2.0
  Attempting uninstall: pillow
    Found existing installation: pillow 11.3.0
    Uninstalling pillow-11.3.0:
      Successfully uninstalled pillow-11.3.0
  Attempting uninstall: nvidia-nvtx-cu12
    Found existing installation: nvidia-nvtx-cu12 12.1.105
    Uninstalling nvidia-nvtx-cu12-12.1.105:
      Successfully uninstalled nvidia-nvtx-cu12-12.1.105
  Attempting uninstall: nvidia-nvjitlink-cu12
    Found existing installation: nvidia-nvjitlink-cu12 12.9.86
    Uninstalling nvidia-nvjitlink-cu12-12.9.86:
      Successfully uninstalled nvidia-nvjitlink-cu12-12.9.86
  Attempting uninstall: nvidia-nccl-cu12
    Found existing installation: nvidia-nccl-cu12 2.21.5
    Uninstalling nvidia-nccl-cu12-2.21.5:
      Successfully uninstalled nvidia-nccl-cu12-2.21.5
  Attempting uninstall: nvidia-curand-cu12
    Found existing installation: nvidia-curand-cu12 10.3.2.106
    Uninstalling nvidia-curand-cu12-10.3.2.106:
      Successfully uninstalled nvidia-curand-cu12-10.3.2.106
  Attempting uninstall: nvidia-cufft-cu12
    Found existing installation: nvidia-cufft-cu12 11.0.2.54
    Uninstalling nvidia-cufft-cu12-11.0.2.54:
      Successfully uninstalled nvidia-cufft-cu12-11.0.2.54
  Attempting uninstall: nvidia-cuda-runtime-cu12
    Found existing installation: nvidia-cuda-runtime-cu12 12.1.105
    Uninstalling nvidia-cuda-runtime-cu12-12.1.105:
      Successfully uninstalled nvidia-cuda-runtime-cu12-12.1.105
  Attempting uninstall: nvidia-cuda-nvrtc-cu12
    Found existing installation: nvidia-cuda-nvrtc-cu12 12.1.105
    Uninstalling nvidia-cuda-nvrtc-cu12-12.1.105:
      Successfully uninstalled nvidia-cuda-nvrtc-cu12-12.1.105
  Attempting uninstall: nvidia-cuda-cupti-cu12
    Found existing installation: nvidia-cuda-cupti-cu12 12.1.105
    Uninstalling nvidia-cuda-cupti-cu12-12.1.105:
      Successfully uninstalled nvidia-cuda-cupti-cu12-12.1.105
  Attempting uninstall: nvidia-cublas-cu12
    Found existing installation: nvidia-cublas-cu12 12.1.3.1
    Uninstalling nvidia-cublas-cu12-12.1.3.1:
      Successfully uninstalled nvidia-cublas-cu12-12.1.3.1
  Attempting uninstall: numpy
    Found existing installation: numpy 1.26.4
    Uninstalling numpy-1.26.4:
      Successfully uninstalled numpy-1.26.4
  Attempting uninstall: networkx
    Found existing installation: networkx 3.5
    Uninstalling networkx-3.5:
      Successfully uninstalled networkx-3.5
  Attempting uninstall: MarkupSafe
    Found existing installation: MarkupSafe 2.1.5
    Uninstalling MarkupSafe-2.1.5:
      Successfully uninstalled MarkupSafe-2.1.5
  Attempting uninstall: fsspec
    Found existing installation: fsspec 2025.9.0
    Uninstalling fsspec-2025.9.0:
      Successfully uninstalled fsspec-2025.9.0
  Attempting uninstall: filelock
    Found existing installation: filelock 3.19.1
    Uninstalling filelock-3.19.1:
      Successfully uninstalled filelock-3.19.1
  Attempting uninstall: triton
    Found existing installation: triton 3.1.0
    Uninstalling triton-3.1.0:
      Successfully uninstalled triton-3.1.0
  Attempting uninstall: nvidia-cusparse-cu12
    Found existing installation: nvidia-cusparse-cu12 12.1.0.106
    Uninstalling nvidia-cusparse-cu12-12.1.0.106:
      Successfully uninstalled nvidia-cusparse-cu12-12.1.0.106
  Attempting uninstall: nvidia-cudnn-cu12
    Found existing installation: nvidia-cudnn-cu12 9.1.0.70
    Uninstalling nvidia-cudnn-cu12-9.1.0.70:
      Successfully uninstalled nvidia-cudnn-cu12-9.1.0.70
  Attempting uninstall: jinja2
    Found existing installation: Jinja2 3.1.6
    Uninstalling Jinja2-3.1.6:
      Successfully uninstalled Jinja2-3.1.6
  Attempting uninstall: nvidia-cusolver-cu12
    Found existing installation: nvidia-cusolver-cu12 11.4.5.107
    Uninstalling nvidia-cusolver-cu12-11.4.5.107:
      Successfully uninstalled nvidia-cusolver-cu12-11.4.5.107
  Attempting uninstall: torch
    Found existing installation: torch 2.5.1+cu121
    Uninstalling torch-2.5.1+cu121:
      Successfully uninstalled torch-2.5.1+cu121
  Attempting uninstall: torchvision
    Found existing installation: torchvision 0.20.1+cu121
    Uninstalling torchvision-0.20.1+cu121:
      Successfully uninstalled torchvision-0.20.1+cu121
  Attempting uninstall: torchaudio
    Found existing installation: torchaudio 2.5.1+cu121
    Uninstalling torchaudio-2.5.1+cu121:
      Successfully uninstalled torchaudio-2.5.1+cu121
Successfully installed MarkupSafe-2.1.5 filelock-3.19.1 fsspec-2025.9.0 jinja2-3.1.6 mpmath-1.3.0 networkx-3.5 numpy-2.3.3 nvidia-cublas-cu12-12.1.3.1 nvidia-cuda-cupti-cu12-12.1.105 nvidia-cuda-nvrtc-cu12-12.1.105 nvidia-cuda-runtime-cu12-12.1.105 nvidia-cudnn-cu12-9.1.0.70 nvidia-cufft-cu12-11.0.2.54 nvidia-curand-cu12-10.3.2.106 nvidia-cusolver-cu12-11.4.5.107 nvidia-cusparse-cu12-12.1.0.106 nvidia-nccl-cu12-2.21.5 nvidia-nvjitlink-cu12-12.9.86 nvidia-nvtx-cu12-12.1.105 pillow-11.3.0 setuptools-70.2.0 sympy-1.13.1 torch-2.5.1+cu121 torchaudio-2.5.1+cu121 torchvision-0.20.1+cu121 triton-3.1.0 typing-extensions-4.15.0
Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: transformers in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (4.42.4)
Requirement already satisfied: pandas in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (2.3.3)
Requirement already satisfied: textstat in /home/kayastha.r/.local/lib/python3.12/site-packages (0.7.11)
Requirement already satisfied: accelerate in /home/kayastha.r/.local/lib/python3.12/site-packages (1.11.0)
Requirement already satisfied: evaluate in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (0.4.6)
Requirement already satisfied: datasets in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (4.2.0)
Requirement already satisfied: rouge-score in /home/kayastha.r/.local/lib/python3.12/site-packages (0.1.2)
Requirement already satisfied: bert-score in /home/kayastha.r/.local/lib/python3.12/site-packages (0.3.13)
Requirement already satisfied: tensorboard in /home/kayastha.r/.local/lib/python3.12/site-packages (2.20.0)
Requirement already satisfied: filelock in /home/kayastha.r/.local/lib/python3.12/site-packages (from transformers) (3.19.1)
Requirement already satisfied: huggingface-hub<1.0,>=0.23.2 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from transformers) (0.34.4)
Collecting numpy<2.0,>=1.17 (from transformers)
  Using cached numpy-1.26.4-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)
Requirement already satisfied: packaging>=20.0 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from transformers) (25.0)
Requirement already satisfied: pyyaml>=5.1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from transformers) (6.0.1)
Requirement already satisfied: regex!=2019.12.17 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from transformers) (2023.10.3)
Requirement already satisfied: requests in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from transformers) (2.32.5)
Requirement already satisfied: safetensors>=0.4.1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from transformers) (0.6.2)
Requirement already satisfied: tokenizers<0.20,>=0.19 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from transformers) (0.19.1)
Requirement already satisfied: tqdm>=4.27 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from transformers) (4.66.4)
Requirement already satisfied: python-dateutil>=2.8.2 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from pandas) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from pandas) (2024.1)
Requirement already satisfied: tzdata>=2022.7 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from pandas) (2023.3)
Requirement already satisfied: pyphen in /home/kayastha.r/.local/lib/python3.12/site-packages (from textstat) (0.17.2)
Requirement already satisfied: nltk in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from textstat) (3.8.1)
Requirement already satisfied: setuptools in /home/kayastha.r/.local/lib/python3.12/site-packages (from textstat) (70.2.0)
Requirement already satisfied: psutil in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from accelerate) (5.9.0)
Requirement already satisfied: torch>=2.0.0 in /home/kayastha.r/.local/lib/python3.12/site-packages (from accelerate) (2.5.1+cu121)
Requirement already satisfied: dill in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from evaluate) (0.3.8)
Requirement already satisfied: xxhash in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from evaluate) (3.6.0)
Requirement already satisfied: multiprocess in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from evaluate) (0.70.16)
Requirement already satisfied: fsspec>=2021.05.0 in /home/kayastha.r/.local/lib/python3.12/site-packages (from fsspec[http]>=2021.05.0->evaluate) (2025.9.0)
Requirement already satisfied: pyarrow>=21.0.0 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from datasets) (21.0.0)
Requirement already satisfied: httpx<1.0.0 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from datasets) (0.28.1)
Requirement already satisfied: absl-py in /home/kayastha.r/.local/lib/python3.12/site-packages (from rouge-score) (2.3.1)
Requirement already satisfied: six>=1.14.0 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from rouge-score) (1.16.0)
Requirement already satisfied: matplotlib in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from bert-score) (3.8.4)
Requirement already satisfied: grpcio>=1.48.2 in /home/kayastha.r/.local/lib/python3.12/site-packages (from tensorboard) (1.76.0)
Requirement already satisfied: markdown>=2.6.8 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from tensorboard) (3.4.1)
Requirement already satisfied: pillow in /home/kayastha.r/.local/lib/python3.12/site-packages (from tensorboard) (11.3.0)
Requirement already satisfied: protobuf!=4.24.0,>=3.19.6 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from tensorboard) (3.20.3)
Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /home/kayastha.r/.local/lib/python3.12/site-packages (from tensorboard) (0.7.2)
Requirement already satisfied: werkzeug>=1.0.1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from tensorboard) (3.0.3)
Requirement already satisfied: aiohttp!=4.0.0a0,!=4.0.0a1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from fsspec[http]>=2021.05.0->evaluate) (3.9.5)
Requirement already satisfied: typing-extensions~=4.12 in /home/kayastha.r/.local/lib/python3.12/site-packages (from grpcio>=1.48.2->tensorboard) (4.15.0)
Requirement already satisfied: anyio in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from httpx<1.0.0->datasets) (4.2.0)
Requirement already satisfied: certifi in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from httpx<1.0.0->datasets) (2024.6.2)
Requirement already satisfied: httpcore==1.* in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from httpx<1.0.0->datasets) (1.0.9)
Requirement already satisfied: idna in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from httpx<1.0.0->datasets) (3.7)
Requirement already satisfied: h11>=0.16 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from httpcore==1.*->httpx<1.0.0->datasets) (0.16.0)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from huggingface-hub<1.0,>=0.23.2->transformers) (1.1.9)
Requirement already satisfied: charset_normalizer<4,>=2 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from requests->transformers) (2.0.4)
Requirement already satisfied: urllib3<3,>=1.21.1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from requests->transformers) (1.26.20)
Requirement already satisfied: networkx in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (3.5)
Requirement already satisfied: jinja2 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (3.1.6)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (2.21.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (12.1.105)
Requirement already satisfied: triton==3.1.0 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (3.1.0)
Requirement already satisfied: sympy==1.13.1 in /home/kayastha.r/.local/lib/python3.12/site-packages (from torch>=2.0.0->accelerate) (1.13.1)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /home/kayastha.r/.local/lib/python3.12/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch>=2.0.0->accelerate) (12.9.86)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /home/kayastha.r/.local/lib/python3.12/site-packages (from sympy==1.13.1->torch>=2.0.0->accelerate) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.1.1 in /home/kayastha.r/.local/lib/python3.12/site-packages (from werkzeug>=1.0.1->tensorboard) (2.1.5)
Requirement already satisfied: contourpy>=1.0.1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from matplotlib->bert-score) (1.2.0)
Requirement already satisfied: cycler>=0.10 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from matplotlib->bert-score) (0.11.0)
Requirement already satisfied: fonttools>=4.22.0 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from matplotlib->bert-score) (4.51.0)
Requirement already satisfied: kiwisolver>=1.3.1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from matplotlib->bert-score) (1.4.4)
Requirement already satisfied: pyparsing>=2.3.1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from matplotlib->bert-score) (3.0.9)
Requirement already satisfied: click in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from nltk->textstat) (8.1.7)
Requirement already satisfied: joblib in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from nltk->textstat) (1.4.2)
Requirement already satisfied: aiosignal>=1.1.2 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2021.05.0->evaluate) (1.2.0)
Requirement already satisfied: attrs>=17.3.0 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2021.05.0->evaluate) (25.4.0)
Requirement already satisfied: frozenlist>=1.1.1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2021.05.0->evaluate) (1.4.0)
Requirement already satisfied: multidict<7.0,>=4.5 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2021.05.0->evaluate) (6.0.4)
Requirement already satisfied: yarl<2.0,>=1.0 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from aiohttp!=4.0.0a0,!=4.0.0a1->fsspec[http]>=2021.05.0->evaluate) (1.9.3)
Requirement already satisfied: sniffio>=1.1 in /shared/EL9/explorer/anaconda3/2024.06/lib/python3.12/site-packages (from anyio->httpx<1.0.0->datasets) (1.3.0)
Using cached numpy-1.26.4-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (18.0 MB)
Installing collected packages: numpy
  Attempting uninstall: numpy
    Found existing installation: numpy 2.3.3
    Uninstalling numpy-2.3.3:
      Successfully uninstalled numpy-2.3.3
Successfully installed numpy-1.26.4
Downloading ROUGE...
Downloading BERTScore...
âœ“ Metrics cached at ~/.cache/huggingface/
CUDA available: True
cuDNN available: True
Repo root: content/m3_repo
Top-level files: ['.git', 'README.md', 'level1.jsonl', 'level2.jsonl', 'level3.jsonl', 'unprocessed1.zip', 'unprocessed2.zip']
JSONL files: ['content/m3_repo/level1.jsonl', 'content/m3_repo/level2.jsonl', 'content/m3_repo/level3.jsonl']
ZIP files: ['content/m3_repo/unprocessed1.zip', 'content/m3_repo/unprocessed2.zip']
Files now in content/m3/raw:
['level1.jsonl', 'level2.jsonl', 'level3.jsonl']

Previewing level1:
Record 1 keys: ['docid', 'target_text', 'input_text', 'input_studies']
Target text (first 120 chars): CONCLUSION: This analysis provides a current evidence-based estimate of PACG prevalence in European derived populations 
Record 2 keys: ['docid', 'target_text', 'input_text', 'input_studies']
Target text (first 120 chars): CONCLUSIONS: Current data suggests that IVB is an effective short-term treatment for diabetic macular edema, and that it

Previewing level2:
Record 1 keys: ['docid', 'target_text', 'input_text', 'input_studies']
Target text (first 120 chars): The result of this meta-analysis suggested a statistically significant association between H. pylori infection and OAG.
Record 2 keys: ['docid', 'target_text', 'input_text', 'input_studies']
Target text (first 120 chars): Further analysis showed that this positive relation is observed only in POAG and NTG patients, but not in the PXFG patie

Previewing level3:
Record 1 keys: ['docid', 'pico', 'discourse_relation', 'target_modality', 'target_direction', 'target_modality_span', 'target_direction_span', 'target_text', 'input_text', 'input_studies']
Target text (first 120 chars): The result of this meta-analysis suggested a statistically significant association between H. pylori infection and OAG.
Record 2 keys: ['docid', 'pico', 'discourse_relation', 'target_modality', 'target_direction', 'target_modality_span', 'target_direction_span', 'target_text', 'input_text', 'input_studies']
Target text (first 120 chars): Further analysis showed that this positive relation is observed only in POAG and NTG patients, but not in the PXFG patie
Cleaned files saved to content/m3/processed/
['level1_clean.jsonl', 'level2_clean.jsonl', 'level3_clean.jsonl']
     Level  n_records  avg_input_words  avg_target_words
0  Level 1        451      3634.053215         49.891353
1  Level 2        315       166.558730         24.038095
2  Level 3        381       125.181102         23.860892
     Level    avg_FRE   avg_FKGL   avg_SMOG
0  Level 1  21.283021  15.562644  16.762802
1  Level 2  24.127514  15.100008  16.119341
2  Level 3  23.102099  15.561667  16.452587
Pearson correlation by level:
  Level 1: 0.046
  Level 2: 0.074
  Level 3: -0.103
Total examples: 1147
Counts overall: Counter({'DOC': 451, 'CLAIM': 381, 'SENT': 315})
Train size: 974, Val size: 173
Train by level: Counter({'DOC': 383, 'CLAIM': 324, 'SENT': 267})
Val by level:   Counter({'DOC': 68, 'CLAIM': 57, 'SENT': 48})
Train samples: 974
Val samples: 173
Tokenized train size: 974
Tokenized val size: 173
Example input length: 1024
Example label length: 512
Extracted to ./p1_model: True
Trainer ready! Train examples: 974 Val examples: 173
{'eval_loss': 0.492721289396286, 'eval_rouge1': 0.2520056414190748, 'eval_rouge2': 0.06727391557042055, 'eval_rougeL': 0.20314190339857788, 'eval_rougeLsum': 0.20324023204068692, 'eval_bertscore_precision': 0.8868943332247652, 'eval_bertscore_recall': 0.8652240282538309, 'eval_bertscore_f1': 0.8755806811972161, 'eval_fkgl_pred': 12.969541239511877, 'eval_fkgl_ref': 15.388215265994468, 'eval_fkgl_diff': 2.4186740264825914, 'eval_smog_pred': 14.449396323182249, 'eval_smog_ref': 16.376475337672606, 'eval_smog_diff': 1.9270790144903565, 'eval_readability_gain': 2.4186740264825914, 'eval_runtime': 32.7973, 'eval_samples_per_second': 5.275, 'eval_steps_per_second': 0.671, 'epoch': 0.99}
{'eval_loss': 0.25877636671066284, 'eval_rouge1': 0.26512762332743767, 'eval_rouge2': 0.0786982983877121, 'eval_rougeL': 0.21930049793947898, 'eval_rougeLsum': 0.2192985097992371, 'eval_bertscore_precision': 0.885992260337565, 'eval_bertscore_recall': 0.8712632094504517, 'eval_bertscore_f1': 0.8782383051910841, 'eval_fkgl_pred': 14.548063504364661, 'eval_fkgl_ref': 15.388215265994468, 'eval_fkgl_diff': 0.8401517616298069, 'eval_smog_pred': 15.42084027015431, 'eval_smog_ref': 16.376475337672606, 'eval_smog_diff': 0.9556350675182959, 'eval_readability_gain': 0.8401517616298069, 'eval_runtime': 24.8565, 'eval_samples_per_second': 6.96, 'eval_steps_per_second': 0.885, 'epoch': 1.97}
{'eval_loss': 0.22825397551059723, 'eval_rouge1': 0.288113268888435, 'eval_rouge2': 0.0980056415709575, 'eval_rougeL': 0.23764027967055157, 'eval_rougeLsum': 0.23781056419886434, 'eval_bertscore_precision': 0.8918582483523154, 'eval_bertscore_recall': 0.8747668548815513, 'eval_bertscore_f1': 0.8828832069573375, 'eval_fkgl_pred': 14.65577573421531, 'eval_fkgl_ref': 15.388215265994468, 'eval_fkgl_diff': 0.7324395317791588, 'eval_smog_pred': 15.485295155970935, 'eval_smog_ref': 16.376475337672606, 'eval_smog_diff': 0.8911801817016709, 'eval_readability_gain': 0.7324395317791588, 'eval_runtime': 23.7137, 'eval_samples_per_second': 7.295, 'eval_steps_per_second': 0.928, 'epoch': 2.99}
{'eval_loss': 0.21384261548519135, 'eval_rouge1': 0.29605125624130024, 'eval_rouge2': 0.09531477558009271, 'eval_rougeL': 0.24131254119841744, 'eval_rougeLsum': 0.24140991938807374, 'eval_bertscore_precision': 0.8931874336534842, 'eval_bertscore_recall': 0.8749759986221446, 'eval_bertscore_f1': 0.8836819643230107, 'eval_fkgl_pred': 14.125629255919485, 'eval_fkgl_ref': 15.388215265994468, 'eval_fkgl_diff': 1.2625860100749833, 'eval_smog_pred': 15.354740563512118, 'eval_smog_ref': 16.376475337672606, 'eval_smog_diff': 1.0217347741604872, 'eval_readability_gain': 1.2625860100749833, 'eval_runtime': 25.3708, 'eval_samples_per_second': 6.819, 'eval_steps_per_second': 0.867, 'epoch': 3.98}
{'eval_loss': 0.20702843368053436, 'eval_rouge1': 0.3075523597849427, 'eval_rouge2': 0.11136416288577894, 'eval_rougeL': 0.254045874207056, 'eval_rougeLsum': 0.2540029073950769, 'eval_bertscore_precision': 0.8953511153342407, 'eval_bertscore_recall': 0.877095667613035, 'eval_bertscore_f1': 0.8858168652291932, 'eval_fkgl_pred': 14.343829532472895, 'eval_fkgl_ref': 15.388215265994468, 'eval_fkgl_diff': 1.0443857335215725, 'eval_smog_pred': 15.396958023364057, 'eval_smog_ref': 16.376475337672606, 'eval_smog_diff': 0.9795173143085485, 'eval_readability_gain': 1.0443857335215725, 'eval_runtime': 24.0911, 'eval_samples_per_second': 7.181, 'eval_steps_per_second': 0.913, 'epoch': 4.99}
{'eval_loss': 0.20234566926956177, 'eval_rouge1': 0.31205471265839646, 'eval_rouge2': 0.11277641097746319, 'eval_rougeL': 0.25634700594349413, 'eval_rougeLsum': 0.25682586615587055, 'eval_bertscore_precision': 0.8932930162187257, 'eval_bertscore_recall': 0.8774811628926007, 'eval_bertscore_f1': 0.8850044904416696, 'eval_fkgl_pred': 14.512860963358602, 'eval_fkgl_ref': 15.388215265994468, 'eval_fkgl_diff': 0.8753543026358663, 'eval_smog_pred': 15.621218104680187, 'eval_smog_ref': 16.376475337672606, 'eval_smog_diff': 0.7552572329924185, 'eval_readability_gain': 0.8753543026358663, 'eval_runtime': 24.1814, 'eval_samples_per_second': 7.154, 'eval_steps_per_second': 0.91, 'epoch': 5.98}
{'eval_loss': 0.20048879086971283, 'eval_rouge1': 0.32136181061135327, 'eval_rouge2': 0.11918727727879803, 'eval_rougeL': 0.25984540151236485, 'eval_rougeLsum': 0.25992796269582896, 'eval_bertscore_precision': 0.8967136330687242, 'eval_bertscore_recall': 0.8802676180194569, 'eval_bertscore_f1': 0.8880892433872113, 'eval_fkgl_pred': 14.392257754468517, 'eval_fkgl_ref': 15.388215265994468, 'eval_fkgl_diff': 0.9959575115259511, 'eval_smog_pred': 15.598929188727269, 'eval_smog_ref': 16.376475337672606, 'eval_smog_diff': 0.777546148945337, 'eval_readability_gain': 0.9959575115259511, 'eval_runtime': 23.843, 'eval_samples_per_second': 7.256, 'eval_steps_per_second': 0.923, 'epoch': 7.0}
{'eval_loss': 0.19989293813705444, 'eval_rouge1': 0.31372792693392104, 'eval_rouge2': 0.10925925752286662, 'eval_rougeL': 0.2536480720027349, 'eval_rougeLsum': 0.25441530907387444, 'eval_bertscore_precision': 0.895709360610543, 'eval_bertscore_recall': 0.877803294300344, 'eval_bertscore_f1': 0.8863495981073104, 'eval_fkgl_pred': 14.19872280815209, 'eval_fkgl_ref': 15.388215265994468, 'eval_fkgl_diff': 1.1894924578423787, 'eval_smog_pred': 15.43924304668383, 'eval_smog_ref': 16.376475337672606, 'eval_smog_diff': 0.937232290988776, 'eval_readability_gain': 1.1894924578423787, 'eval_runtime': 23.5395, 'eval_samples_per_second': 7.349, 'eval_steps_per_second': 0.935, 'epoch': 7.89}
{'train_runtime': 566.3918, 'train_samples_per_second': 13.757, 'train_steps_per_second': 0.424, 'train_loss': 0.42916835149129234, 'epoch': 7.89}
Training finished.

Generating predictions for 173 validation examples...
Progress: 0/173
Progress: 25/173
Progress: 50/173
Progress: 75/173
Progress: 100/173
Progress: 125/173
Progress: 150/173

Computing metrics by level...

================================================================================
VALIDATION RESULTS BY LEVEL
================================================================================

Level  n ROUGE-1 ROUGE-2 ROUGE-L BERTScore-F1 Input_FKGL Gen_FKGL FKGL_Diff
  DOC 68  0.2919  0.0878  0.2223       0.8809      13.54    15.13     -1.59
 SENT 48  0.2901  0.0898  0.2309       0.8890      14.26    14.44     -0.18
CLAIM 57  0.3804  0.1785  0.3232       0.8951      12.66    13.63     -0.97

================================================================================
OVERALL VALIDATION RESULTS
================================================================================

ROUGE-1:    0.3207
ROUGE-2:    0.1190
ROUGE-L:    0.2585
BERTScore:  0.8878

Input FKGL:     13.45
Generated FKGL: 14.44
Difference:     -1.00 grade levels

================================================================================
Picking sample 163

================================================================================
Example 1 - CLAIM
================================================================================
INPUT (first 200 chars): <LEVEL:CLAIM> Primary small-incision cataract surgery using phacoemulsification and foldable intraocular lens implantation may be the procedure of choice in patients with medically controlled glaucoma...
REFERENCE: Phaco-GSL might be an optimal procedure to treat ACG with concomitant cataract due to its bleb-less nature, and its capacity for lowering IOP seems superior to Phaco alone and comparable to Phaco-trab...
GENERATED: Combination phacoemulsification, intraocular lens implantation, and trabeculectomy may be the most effective cataract surgery for patients with primary angle-closure glaucoma....
Picking sample 28

================================================================================
Example 2 - DOC
================================================================================
INPUT (first 200 chars): <LEVEL:DOC> PURPOSE: To prospectively evaluate the effect of early aqueous suppression (therapy) on hypertensive phase (HP) and intraocular pressure (IOP) control after implantation of silicone Ahmed ...
REFERENCE: AUTHORS' CONCLUSIONS: Information was insufficient to conclude whether there are differences between aqueous shunts and trabeculectomy for glaucoma treatment. While the Baerveldt implant may lower IOP...
GENERATED: CONCLUSIONS: AGV implantation is associated with a lower incidence of IOP spikes compared with BGI implantation....
Picking sample 6

================================================================================
Example 3 - DOC
================================================================================
INPUT (first 200 chars): <LEVEL:DOC> PURPOSE: To validate known and determine new predictors of non-response to ranibizumab in patients with neovascular age-related macular degeneration (AMD) and to incorporate these factors ...
REFERENCE: In conclusion, pharmacogenetics of CFH Y402H polymorphism may play a role in response to anti-VEGF treatment for neovascular AMD, especially for Caucasians....
GENERATED: CONCLUSIONS: This meta-analysis suggests that the A polymorphism is associated with an increased risk of non-response to anti-VEGF treatment in patients with exudative AMD....
